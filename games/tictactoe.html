<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tic-Tac-Toe</title>
    <link rel="stylesheet" href="../assets/site.css" />
    <style>
      #board {
        display: grid;
        grid-template-columns: repeat(3, 90px);
        gap: 10px;
      }
      .cell {
        width: 90px;
        height: 90px;
        font-size: 2.5rem;
        text-transform: uppercase;
      }
    </style>
  </head>
  <body>
    <div class="wrapper fade-in">
      <a class="back-link" href="../index.html">Back to Hub</a>
      <div class="page-title">
        <h2>Tic-Tac-Toe</h2>
        <div class="controls">
          <button id="reset">Reset</button>
        </div>
      </div>

      <div class="game-shell">
        <div class="game-panel">
          <div id="board"></div>
        </div>
        <div class="game-panel">
          <strong>How to play</strong>
          <div class="note">You are X. Click a tile to place.</div>
          <div class="note" id="status">Your move.</div>
        </div>
      </div>
    </div>

    <script>
      const boardEl = document.getElementById("board");
      const statusEl = document.getElementById("status");
      const resetBtn = document.getElementById("reset");
      let board = Array(9).fill("");
      let gameOver = false;

      function render() {
        boardEl.innerHTML = "";
        board.forEach((value, index) => {
          const btn = document.createElement("button");
          btn.className = "cell";
          btn.textContent = value;
          btn.addEventListener("click", () => play(index));
          boardEl.appendChild(btn);
        });
      }

      function winner(b) {
        const lines = [
          [0, 1, 2],
          [3, 4, 5],
          [6, 7, 8],
          [0, 3, 6],
          [1, 4, 7],
          [2, 5, 8],
          [0, 4, 8],
          [2, 4, 6],
        ];
        for (const [a, c, d] of lines) {
          if (b[a] && b[a] === b[c] && b[a] === b[d]) return b[a];
        }
        return null;
      }

      function play(index) {
        if (gameOver || board[index]) return;
        board[index] = "X";
        if (winner(board)) {
          statusEl.textContent = "You win.";
          gameOver = true;
          render();
          return;
        }
        if (board.every((cell) => cell)) {
          statusEl.textContent = "Draw.";
          gameOver = true;
          render();
          return;
        }
        aiMove();
      }

      function aiMove() {
        const empty = board
          .map((value, index) => (value === "" ? index : null))
          .filter((value) => value !== null);
        const pick = empty[Math.floor(Math.random() * empty.length)];
        board[pick] = "O";
        if (winner(board)) {
          statusEl.textContent = "AI wins.";
          gameOver = true;
        } else if (board.every((cell) => cell)) {
          statusEl.textContent = "Draw.";
          gameOver = true;
        } else {
          statusEl.textContent = "Your move.";
        }
        render();
      }

      resetBtn.addEventListener("click", () => {
        board = Array(9).fill("");
        gameOver = false;
        statusEl.textContent = "Your move.";
        render();
      });

      render();
    </script>
  </body>
</html>
